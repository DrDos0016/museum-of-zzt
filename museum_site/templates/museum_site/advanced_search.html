{% extends "museum_site/main.html" %}

{% block style %}
<style>
.detail-cat
{
    border:1px solid red;
}
</style>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function (){
    $("#advanced-search-form button").click(function (){
        if ($(this).text() == "All")
        {
            $("input[name=details]").prop("checked", "checked");
            $("input[name=details]").parent().addClass("selected");
        }
        else if ($(this).text() == "None")
        {
            $("input[name=details]").prop("checked", "");
            $("input[name=details]").parent().removeClass("selected");
        }
        else if ($(this).text() == "Default")
        {
            $("input[name=details]").prop("checked", "");
            $("input[name=details]").parent().removeClass("selected");
            $("input[name=details][value=13]").prop("checked", "checked");
            $("input[name=details][value=13]").parent().addClass("selected");
            $("input[name=details][value=14]").prop("checked", "checked");
            $("input[name=details][value=14]").parent().addClass("selected");
            $("input[name=details][value=15]").prop("checked", "checked");
            $("input[name=details][value=15]").parent().addClass("selected");
        }
        update_selected_details();
    });

    $("input[name=details]").click(function (){
        $(this).parent().toggleClass("selected");
        update_selected_details();
    });

    update_selected_details();
});

function update_selected_details()
{
    var output = "";
    $("input[name=details]").each(function (){
        if ($(this).prop("checked"))
        {
            output += $(this).parent().text() + ", "
        }
    });

    if (output != "")
        output = "Selected Criteria:<br>" + output.slice(0, -2);
    else
        output = "Selected Criteria:<br>None";

    $("#details-selected").html(output)
}
</script>
{% endblock %}

{% block content %}
<section id="content" class="block">

<h1>Advanced Search</h1>

<form method="GET" action="{% url 'search' %}" id="advanced-search-form">
<div class="field">
    <label for="title">Title contains:</label>
        <span class="sub"></span>
    <input id="title" name="title" value="{{request.GET.title}}" maxlength="80">
</div>
<div class="field">
    <label for="author">Author contains:<br>
        <span class="sub"></span>
    </label>
    <input id="author" name="author" value="{{request.GET.author}}" maxlength="254">
</div>
<div class="field">
    <label for="filename">Filename contains:</label>
        <span class="sub"></span>
    <input id="filename" name="filename" value="{{request.GET.filename}}" maxlength="80">
</div>
<div class="field">
    <label for="company">Company contains:<br>
        <span class="sub"></span>
    </label>
    <input id="company" name="company" value="{{request.GET.company}}" maxlength="50">
</div>
<div class="field">
    <label for="genre">Genre:<br>
    </label>
    <select id="genre" name="genre">
        <option value="Any">- ANY - </option>
        {% for genre in genres %}
            {% if genre == request.GET.genre %}
            <option selected>{{genre}}</option>
            {% else %}
            <option>{{genre}}</option>
            {% endif %}
        {% endfor %}
    </select>
</div>
<div class="field">
    <label for="min">Min. / max. board count:<br>
    </label>
    <div id="board-count" class="field-group">
        <input name="board_min" value="{{request.GET.board_min|default:''}}" min=0 max=32767 maxlength="5" type="number">
        <div class="c">to</div>
        <input name="board_max" value="{{request.GET.board_max|default:''}}" min=0 max=32767 maxlength="5" type="number">
        <div class="board-type-select">
            <label><input name="board_type" value="playable" type="radio"{% if request.GET.board_type == 'playable' %}checked {% endif %}> Playable Boards</label>
            <label><input name="board_type" value="total" type="radio"{% if request.GET.board_type != 'playable' %}checked {% endif %}> Total Boards</label>
        </div>
    </div>
</div>
<div class="field">
    <label for="year">Release year:<br>
    </label>
    <select id="year" name="year">
        <option value="Any">- ANY - </option>
        <option value="Unk">Unknown</option>
        {% for year in years %}
            {% if year == request.GET.year %}
            <option selected>{{year}}</option>
            {% else %}
            <option>{{year}}</option>
            {% endif %}
        {% endfor %}
    </select>
</div>
<div class="field">
    <label for="min">Min. / max. rating:<br>
    </label>

    <div id="board-count" class="field-group">
        <input id="min" name="min" value="{{request.GET.min|default:'0.0'}}" min=0.0 max=5.0 maxlength="4" type="number" step=0.1>
        <div class="c">to</div>
        <input id="max" name="max" value="{{request.GET.max|default:'5.0'}}" min=0.0 max=5.0 maxlength="4" type="number" step=0.1>
    </div>
</div>
<div class="field">
    <label for="lang">Language:<br>
    </label>
    <select id="lang" name="lang">
        <option value="Any">- ANY - </option>
        <option value="non-english">- Non-English - </option>
        {% for l in languages %}
            {% if l == request.GET.lang %}
            <option value="{{l.0}}" selected>{{l.1}}</option>
            {% else %}
            <option value="{{l.0}}">{{l.1}}</option>
            {% endif %}
        {% endfor %}
    </select>
</div>
<div class="field">
    <label for="min">Associated Content:<br>
    </label>

    <div id="associated-content" class="field-group">
        <div class="field-row">
            <label><input name="reviews" type="radio" value="yes"{% if request.GET.reviews == 'yes' %} checked{% endif %}> Show files with reviews</label>
            <label><input name="reviews" type="radio" value="no"{% if request.GET.reviews == 'no' %} checked{% endif %}> Show files without reviews</label>
            <label><input name="reviews" type="radio" value="any"{% if request.GET.reviews == 'any' or not request.GET.reviews %} checked{% endif %}> Show both</label>
        </div>

        <div class="field-row">
            <label><input name="articles" type="radio" value="yes"{% if request.GET.articles == 'yes' %} checked{% endif %}> Show files with articles</label>
            <label><input name="articles" type="radio" value="no"{% if request.GET.articles == 'no' %} checked{% endif %}> Show files without articles</label>
            <label><input name="articles" type="radio" value="any"{% if request.GET.articles == 'any' or not request.GET.articles %} checked{% endif %}> Show both</label>
        </div>
    </div>
</div>
{% include 'museum_site/blocks/content_field.html' %}
<div class="field">
    <label for="sort">Sort results by:<br>
    </label>
    <select id="sort" name="sort">
        <option value="title"{% if request.GET.sort == "title" %} selected {% endif %}>Title</option>
        <option value="author"{% if request.GET.sort == "author" %} selected {% endif %}>Author</option>
        <option value="company"{% if request.GET.sort == "company" %} selected {% endif %}>Company</option>
        <option value="rating"{% if request.GET.sort == "rating" %} selected {% endif %}>Rating</option>
        <option value="release"{% if request.GET.sort == "release" %} selected {% endif %}>Release Date</option>
    </select>
</div>

<div class="field">
    <button type="submit" id="submit-search-button">Search</button>
</div>
<input type="hidden" name="advanced" value="1">
</form>

</section>
{% endblock %}
