{% extends "museum_site/main.html" %}
{% load static %}
{% load markdown_deux_tags %}

{% block scripts %}
<script>
$(document).ready(function (){
    $("#id_title").change(update_url);
    update_url();
});

function update_url()
{
    var raw = $("#id_title").val();

    var formatted = raw.trim().replace(/ /g, "-").replace(/[^0-9a-zA-Z_-]/gi, "").toLowerCase();
    $("#collection-url-preview").text(formatted);
}
</script>
{% endblock %}

{% block content %}
<section id="content" class="block {{request.resolver_match.url_name|default:'null_url_name'}}">
<h1>{{title}}</h1>

<p>Collections are created in two steps. This page is used to create an empty collection. After creating the collection, you will be taken to a page where files can be added to it.</p>

<form method="POST">
{% csrf_token %}

{% csrf_token %}
{% for field in form.visible_fields %}
<div class="field-wrapper{% if field.errors %} field-with-error{% endif %}" data-field="{{field.name}}">
    {{field.label_tag}}
    <div class="field-value">
        {{field|safe}}
        {% if field.id_for_label == "id_title" %}<div>Collection URL: <span id="collection-url-preview"></span></div>{% endif %}
    </div>
    {% if field.help_text %}
    <p class="field-help">{{field.help_text|safe}}</p>
    {% endif %}
    {{field.errors}}
</div>
{% endfor %}
{% for field in form.hidden_fields %}
{{field}}
{% endfor %}

<input type="submit" value="Create Collection">

</form>
</section>
{% endblock %}
