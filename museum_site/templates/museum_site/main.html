{% load static %}
{% load site_tags %}
{% load zzt_tags %}
<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{% block title %}{{title}}{% endblock %}{% if title %} - {% endif %}Museum of ZZT</title>
{% for file in CSS_INCLUDES %}<link rel="stylesheet" type="text/css" href="{% static 'css/'|add:file %}?{{BOOT_TS}}">{% endfor %}
<link rel="shortcut icon" href="{% static 'chrome/favicon.png' %}">
{% block meta %}{% meta_tags path=request.get_full_path %}{% endblock %}
{% block analytics %}
{% if request.get_host == "museumofzzt.com" %}
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45185267-6', 'auto');
  ga('send', 'pageview');

</script>
{% else %}<!--N/A-->{% endif %}
{% endblock %}
<script src="/static/js/jquery.3.1.0.min.js"></script>
<script src="{% static 'js/museum.js' %}?{{BOOT_TS}}"></script>
{% block scripts %}{% endblock %}
{% block staff_scripts %}{% endblock %}
{% block style %}{% endblock %}
{% block staff_style %}{% endblock %}
</head>

<body class="grid-root{% if april %} april {% endif %}" id="top">
<nav id="low-res-shortcuts" class="cp437">
    <a href="#top-links" class="nohover">▼ Navigation ▼</a>
</nav>

<section id="sidebar-left" class="sidebar">
    <header id="logo-area">
        {% if ENV != "DEV" %}<a href="/" id="logo"><img src="{% static 'chrome/logos/museum-logo-by-lazymoth.png' %}" alt="Museum of ZZT Logo by LazyMoth"></a>
        {% else %}<a href="/" id="logo"><img src="{% static 'chrome/logos/museum-logo-by-lazymoth-INVERTED.png' %}" alt="Museum of ZZT Logo by LazyMoth"></a>
        {% endif %}
    </header>

    <div id="featured" class="block c">
        <h2 class="l">Featured World️</h2>
        {% gblock fg "gallery" %}
        <a href="{% url 'featured_games' %}" id="fp-fw-link">View All Featured Worlds</a>
    </div>

    <div id="worlds-block" class="block l">
        <h2>File Archives</h2>
        <div id="letters" class="c cp437">
            <a href="{% url 'browse_letter' '1'%}">#</a>{% for l in "ABCDEFGHIJKLMNOPQRSTUVWXYZ" %}
            <a href="{% url 'browse_letter' l|lower %}">{{l}}</a>{% endfor %}
        </div>
        <div id="letters-select">
            <select id="letter-select">
                <option value="">By Letter</option>
                <option value="1">#</option>{% for l in "ABCDEFGHIJKLMNOPQRSTUVWXYZ" %}
                <option value="{{l}}">{{l}}</option>{% endfor %}
            </select>
            <input id="letter-button" type="button" value="Go">
        </div>
        <div class="world-special">
            <a href="{% url 'browse' %}">All Files</a>
            <a href="{% url 'browse_collections' %}">Collections</a>
            <a href="{% url 'mass_downloads' %}">Mass Downloads</a>
            <a href="{% url 'new_finds' %}">New Finds</a>
            <a href="{% url 'new_releases' %}">New Releases</a>
            <a href="{% url 'random' %}">Random ZZT World</a>
            <a href="{% url 'roulette' %}">Roulette</a>
            <a href="{% url 'uploaded_worlds' %}">Upload Queue ({{UPLOAD_QUEUE_SIZE}})</a>
        </div>
        <form method="GET" action="{% url 'search' %}">
        <div id="search-form">
            <input name="q" value="{{request.GET.q|default:''}}" list="search-suggestions" autocomplete="off" placeholder="Title/Author/Genre/Filename" data-click-select><div class="low-res-break"></div>
            <input id="search-button" type="submit" value="Search">
        </div>
        </form>
        <div class="advanced-search">
            <a href="{% url 'advanced_search' %}">Advanced Search</a>
        </div>
    </div>

    <div id="downloads-block" class="block">
        <h2>Essentials</h2>
        <a href="{% url 'zzt_dl' %}">ZZT</a>
        <a href="http://zeta.asie.pl/" target="_blank">Zeta</a>
        <a href="https://github.com/cknave/kevedit" target="_blank">KevEdit</a>
        <a href="https://zedit2.skyend.net/" target="_blank">zedit2</a>
        <a href="https://github.com/asiekierka/reconstruction-of-zzt" target="_blank">The Reconstruction of ZZT</a>
        <a href="https://github.com/DrDos0016/zookeeper" target="_blank">Zookeeper</a>
    </div>

    <div class="block">
        <h2>Specialty Archives</h2>
        <a href="{% url 'szzt_worlds' %}">Super ZZT Worlds</a>
        <a href="{% url 'utilities' %}">External Utilities</a>
        <a href="{% url 'zig_worlds' %}">ZIG Worlds</a>
        <a href="{% url 'zzm_audio' %}">ZZM Audio</a>
        <a href="{% url 'file_details' %}">All Details</a>
    </div>
</section>

<main id="content" class="block{% for class in content_classes %} {{class}}{% endfor %}" data-url-name="{{request.resolver_match.url_name|default:'null_url_name'}}">
{% block zfile_header %}
{% if file %}
    <button class="fr contracted" id="expand-contract" title="Toggle sidebars">&larr; &rarr;</button>
    {% if file and not local%}
    <div class="file-header">
        {% include "museum_site/datum/title-datum.html" with f=file.title_datum_context %}
        {% if multifile %}
        <select id="alt-file-listing" name="associated_file">
            <option value="{{file.filename}}">+{{zgames|length|add:"-1"}} Other associated file{% if zgames|length > 2 %}s{% endif %}</option>
            {% for zgame in zgames %}
                {% if zgame.id != file.id %}<option value="{{zgame.filename}}">{{zgame.title}}</option>{% endif %}
            {% endfor %}
        </select>{% endif %}
    </div>
    <div class="file-links">
        {% zfile_links zfile=file debug=request.session.DEBUG %}
    </div>
    <div class="file-data">
        <div class="author-data">Author<br>{% for a in file.author_list %}<a href="{% url 'search' %}?author={{a|urlencode}}">{{a}}</a>{% if not forloop.last %}, {% endif %}{% endfor %}</div>
        <div class="release-data">Released<br><a href="{% url 'search' %}?year={{file.release_date.year|default:'Unk'}}" title="{% if file.release_date %}Source: {{file.release_source}}{% endif %}">{{file.release_date|default:"Unknown"}}</a></div>
        <div class="genre-data">Genre<br> {% for g in file.genres.all %}<a href="{% url 'search' %}?genre={{g}}">{{g}}</a>{% if not forloop.last %}, {% endif %}{% endfor %}</div>
        <div class="company-data">Company<br>{% for c in file.company_list %}<a href="{% url 'search'%}?company={{c|urlencode}}">{{c}}</a>{% if not forloop.last %}, {% endif %}{% endfor %}</div>
        <div class="size-data">Size<br>{{file.size|filesizeformat}}</div>
        {% if file.total_boards %}<div class="board-data">Boards<br> <span title="Playable/Total - Values are not 100% accurate">{{file.playable_boards}} / {{file.total_boards}}</span></div>{% endif %}
        <div class="Dating-data">Rating<br> {%if file.rating != None %}<span title="Based on {{file.review_count}} review{{file.review_count|pluralize}}">{{file.rating|floatformat:"2"}} / 5.00</span>{% else %}<em>No rating</em>{% endif %}</div>
    </div>
    {% endif %}
    {% if local %}
    <h1>Local File Viewer - <input type="file" id="local-file-path"> <button id="local-load">Load File</button></h1>
    {% endif %}
{% endif %}
{% endblock zfile_header %}
{% block content %}
{% endblock %}
</main>

<section id="sidebar-right" class="sidebar">
    <nav id="top-links" class="cp437">
        <a id="top-link-div" class="nav-link nohover" href="#top"><div class="text">Top of page</div></a>
        <a href="{% url 'about_zzt' %}" class="nav-link nohover"><div class="key">A</div><div class="text">About<span class="optional"> ZZT</span></div></a>
        <a href="{% url 'upload' %}" class="nav-link nohover"><div class="key">U</div><div class="text">Upload</div></a>
        <a href="{% url 'support' %}" class="nav-link nohover"><div class="key">S</div><div class="text">Support</div></a>
        <a href="{% url 'discord' %}" class="nav-link nohover"><div class="key">D</div><div class="text">Discord</div></a>
        <a href="http://zzt.org/fora" class="nav-link nohover"><div class="key">Z</div><div class="text"><span class="optional"> z2 </span>Forums</div></a>
        {% if user.is_authenticated %}<a href="{% url 'my_profile' %}" class="nav-link nohover" title="Logged in as: {{user.username}}"><div class="key">{% char user.profile.char user.profile.fg user.profile.bg scale=2 %}</div><div class="text">Profile</div></a>{% else %}
        <a href="{% url 'login_user' %}" class="nav-link nohover"><div class="key">{% char 1 "black" "transparent" %}</div><div class="text">Account</div></a>{% endif %}
        {% if user.is_staff %}
        <a href="{% url 'tool_index' %}" class="nav-link nohover"><div class="key">T</div><div class="text">Tools</div></a>
        {% endif %}
    </nav>

    <div class="block">
        <h2>Exhibits</h2>

        <h3>Worlds of ZZT</h3>
        <a href="{% url 'article_category' 'closer-look' %}">Closer Looks</a>
        <a href="{% url 'article_category' 'livestream' %}">Livestreams</a>
        <a href="{% url 'article_category' 'publication-pack' %}">Publication Packs</a>

        <h3>Articles</h3>
        <a href="{% url 'article_categories' %}">Articles By Category</a>
        <a href="{% url 'article_directory' %}">Article Directory</a>
        <a href="{% url 'series_directory' %}">Articles By Series</a>
        <a href="{% url 'article_search' %}">Search Articles</a>

        <h3>Reviews</h3>
        <a href="{% url 'review_directory' %}">Review Directory</a>
        <a href="{% url 'reviewer_directory' %}">Reviewer Directory</a>
        <a href="{% url 'review_search' %}">Search Reviews</a>

        <h3>Directories</h3>
        <a href="{% url 'directory' 'author' %}">Author Directory</a>
        <a href="{% url 'directory' 'company' %}">Company Directory</a>
        <a href="{% url 'directory' 'genre' %}">Genre Directory</a>

        <h3>Playing ZZT Worlds</h3>
        <a href="{% url 'zeta' %}">Using ZZT with Zeta</a>
        <a href="{% url 'article_category' 'walkthrough' %}">Walkthroughs</a>
        <a href="{% url 'zzt_cheats' %}">ZZT Cheats</a>

        <h3>Editing ZZT Worlds</h3>
        <a href="{% url 'ascii' %}">ASCII Characters</a>
        <a href="{% url 'local_file' %}">Local File Viewer</a>

        <h3>Historical</h3>
        <a href="http://zzt.org" target="_blank">z2 ZZT Archive</a>
        <a href="{% url 'clones' %}">ZZT Clones</a>
        <a href="{% url 'comic_index' %}">ZZT Comics Archive</a>
    </div>

    <div id="wozzt-block" class="block">
        <h2>Worlds of ZZT</h2>
        <div id="social">
            <a class="inline nohover" href="https://twitter.com/worldsofzzt" target="_blank"><img src="{% static 'icons/Twitter_Social_Icon_Rounded_Square_Color.png' %}" alt="Twitter" title="Twitter"></a>
            <a class="inline nohover" href="{% url 'discord' %}"><img src="{% static 'icons/Discord-Logo-Color.png' %}" alt="Discord" title="Worlds of ZZT Discord"></a>
            <a class="inline nohover" href="https://patreon.com/worldsofzzt" target="_blank"><img src="{% static 'icons/patreon_logo.png' %}" alt="Patreon" title="Patreon"></a>
            <a class="inline nohover" href="https://www.youtube.com/c/WorldsofZZT" target="_blank"><img src="{% static 'icons/YouTube-social-squircle_red_24px.png' %}" alt="YouTube" title="YouTube"></a>
            <a class="inline nohover" href="https://twitch.tv/worldsofzzt" target="_blank"><img src="{% static 'icons/Glitch_Purple_RGB.png' %}" alt="Twitch" title="Twitch"></a>
            <a class="inline nohover" href="https://github.com/DrDos0016/museum-of-zzt" target="_blank"><img src="{% static 'icons/GitHub-Mark-32px.png' %}" alt="GitHub" title="GitHub"></a>
            <a class="inline nohover" href="{% url 'rss_feeds' %}"><img src="{% static 'icons/rss-large.png' %}" alt="RSS Feeds" title="RSS Feeds"></a>
        </div>

        <div id="policies">
            <h3>Policies</h3>
            <a href="{% url 'correction_policy' %}">Correction Policy</a>
            <a href="{% url 'data_integrity' %}">Data Integrity</a>
            <a href="{% url 'removal_policy' %}">Removal Policy</a>
            <a href="{% url 'review_policy' %}">Review Policy</a>
            <a href="{% url 'credits' %}">Site Credits</a>
            <a href="{% url 'upload_policy' %}">Upload Policy</a>
        </div>

        <div id="patreon-links">
            <h3>Patron Exclusives</h3>
            <a href="{% url 'poll_index' %}">$1+ Closer Look Poll</a>
            <a href="{% url 'patron_articles' %}">$2+ Early Articles</a>
            <a href="https://beta.museumofzzt.com">$5+ Private Beta</a>
        </div>
    </div>
</section>

<footer id="footer">
    - Museum of ZZT -
{% if drupe %}Happy Drupe Day! -{% endif %}
<br>
&copy; 2015-{{datetime.year}} <a href="mailto:{{EMAIL_ADDRESS}}">Dr. Dos</a><br>
Additional content copyright its  <a href="{% url 'credits' %}">respective owners</a><br>
Server Time: {{datetime}}<br>
<a href="{% url 'my_profile' %}">View my data</a><br>
{% if debug %}
<div class="debug">
Device Resolution: <span id="debug-res"></span><br>
Page Dimensions: <span id="debug-view"></span><br>
<textarea style="width:100ch;height:50px;max-width:90vw;margin:auto;">
Domain: {{DOMAIN}}
Absolute URI: {{request.build_absolute_uri}}
HTTP_HOST: {{request.META.HTTP_HOST}} | Host: {{HOST}} | Env: {{ENV}}
</textarea><br>
View this page on: <a href="https://beta.museumofzzt.com{{request.path}}" target="_blank">BETA</a> <a href="https://museumofzzt.com{{request.path}}" target="_blank">LIVE</a>
<br>
<table id="meta-tags" class="data-table" style="max-width:800px;margin:auto;background:#FFF;">
</table>
</div>

<script>
$("#debug-res").text($(window).width() + "x" + $(window).height());
$("#debug-view").text($("body").width() + "x" + $("body").height());
</script>
{% endif %}
{% if user.is_staff %}
<a id="showdebug" class="jsLink">TOGGLE DEBUG CLASS</a><br>
<script>
$("#showdebug").click(function (){
    $(".debug").toggle();
});

$("meta").each(function (){
    var key = $(this).attr("name");
    if (! key)
        key = $(this).attr("property");

    var val = $(this).attr("content");

    if (key == "og:image")
        var row = `<tr><th>${key}</th><td class="l">${val}</td><td rowspan="9"><img src="${val}"></td></tr>`;
    else
        var row = `<tr><th>${key}</th><td class="l">${val}</td></tr>`;
    $("#meta-tags").html($("#meta-tags").html() + row);
});
</script>
{% endif %}
</footer>

<datalist id="search-suggestions">
</datalist>

{% if april %}{% include "museum_site/april.html" %}{% endif %}
</body>
</html>
