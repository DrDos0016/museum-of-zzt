{% extends "museum_site/world.html" %}

{% block scripts %}
<script>
$(document).ready(function (){
    var speed = 3000;
    $(window).keyup(function (e){
        if (e.ctrlKey)
            console.log(e.keyCode);
    });

    $("select[name=player]").change(function (){
        window.location = "?player=" + $(this).val();
    });
});
</script>
{% if player == "cerulean" %}
<script type="text/javascript" src="/static/cerulean86/zzt_preload.js"></script>
<script type="text/javascript">
    window.onload = function() {
        zzt_emu_load("/static/cerulean86/", {
            files: [
            {% if file.is_super_zzt %}
                "/static/data/cerulean86_engines/szzt.zip",
            {% else %}
                "/static/data/cerulean86_engines/zzt.zip",
            {% endif %}
            "{{DOMAIN}}{{file.download_url}}"],
            charset_png:
            {% if custom_charset %}
                "/static/images/charsets/{{custom_charset}}"
            {% else %}
                "/static/images/charsets/cp437.png"
            {% endif %}
        });
    };
</script>
{% endif %}
{% endblock %}

{% block world_content %}
<div id="play-area">
    {% if player == "archive" %}
    <iframe src="https://archive.org/embed/{{file.archive_name}}" width="640" height="480" frameborder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen></iframe>
    {% elif player == "cerulean" %}
    <canvas id="zzt_canvas" width="640" height="350"></canvas>
    {% endif %}
</div>

{% if ENV != "PROD" %}
<div id="player-list" class="c">
    <b>Play Method</b><br>
    <select name="player">
        {% for k, info in players.items %}
        <option value="{{k}}"{% if k == player %} selected{% endif %}>{{info.name}}</option>
        {% endfor %}
    </select>
</div>
{% endif %}

<div class="play-instructions">
{% if player == "archive" %}
This file is hosted on <a href="https://archive.org/details/softwarelibrary_msdos_zzt" target="_blank">The Internet Archive's ZZT Software Library</a><br>
<a href="https://archive.org/details/{{file.archive_name}}" target="_blank">Open this file on archive.org</a><br>
<a href="https://archive.org/about/faqs.php#MS-DOS_Emulation" target="_blank">Internet Archive MS-DOS Emulation Help</a><br>
<br>
If the world appears to be running too slow, pressing <b>Control+F12</b> will increase the emulated CPU instructions.<br>Similarly, <b>Control+F11</b> will decrease emulated CPU instructions.</b>
{% endif %}
</div>
{% endblock %}
