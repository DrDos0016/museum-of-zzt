{% extends "museum_site/main.html" %}
{% load static %}
{% load site_tags %}

{% block content %}
{% gblock file %}

<h2 id="heading-attr">File Attributes</h2>
<table class="data-table">
<tr><th>Aliases</th><td><a href="#heading-aliases">{{file.aliases.count}}</a></td></tr>
<tr><th>Articles</th><td><a href="#heading-articles">{{file.article_count}}</a></td></tr>
<tr><th>Author</th><td>{{file.author}}</td></tr>
<tr><th>Boards Playable/Total</th><td>{{file.playable_boards}} / {{file.total_boards}}</td></tr>
<tr><th>MD5 Checksum</td><td class="caps">{{file.checksum}}</td></tr>
<tr><th>Company</th><td>{{file.company|default:"<i>No company</i>"}}</td></tr>
<tr><th>Explicit</th><td>{{file.explicit}}</td></tr>
<tr><th>Description</th><td>{% if file.description %}<textarea>{{file.description}}</textarea>{% else %}<i>No description</i>{% endif %}</td></tr>
<tr><th>Alternate Downloads</th><td><a href="#heading-downloads">{{file.downloads.count}}</a></td></tr>
<tr><th>Details</th><td><a href="#heading-details">{{file.details.count}}</a></td></tr>
<tr><th>File Exists</th><td>{{file.file_exists}}</td></tr>
<tr><th>Filename</th><td>{{file.filename}}</td></tr>
<tr><th>Key</th><td>{{file.key|default:"<i>No key set</i>"}}</td></tr>
<tr><th>Genre</th><td>{% for g in file.genre_list %}{{g}}{% if not forloop.last %}, {% endif %}{% endfor %}</td></tr>
<tr><th>ID</th><td>{{file.id}}</td></tr>
<tr><th>Internet Archive Identifier</th><td>{% if file.archive_name %}<a href="https://archive.org/details/{{file.archive_name}}" target="_blank">{{file.archive_name}}{% else %}<i>None</i>{% endif %}</td></tr>
<tr><th>Language</th><td>{{file.language_list}}</td></tr>
<tr><th>Last Modified</th><td>{{file.last_modified}}</td></tr>
<tr><th>Letter</th><td class="caps">{{file.letter}}</td></tr>
<tr><th>Publish Date</th><td>{{file.publish_date}}</td></tr>
<tr><th>Rating</th><td>{{file.rating}} / 5.00</td></tr>
<tr><th>Release Date</th><td>{{file.release_date}}</td></tr>
<tr><th>Release Date Source</th><td>{{file.release_source}}</td></tr>
<tr><th>Reviews</th><td><a href="#heading-reviews">{{file.review_count}}</a></td></tr>
<tr><th>Preview Image Filename</th><td><a href="{% static file.screenshot_url %}" target="_blank">{{file.screenshot}}</a></td></tr>
<tr><th>Size</th><td>{{file.size}} bytes ({{file.size|filesizeformat}})</td></tr>
<tr><th>Supports Zeta Player</th><td>{{file.supports_zeta_player}}</td></tr>
<tr><th>Title</th><td>{{file.title}}</td></tr>
<tr><th>Upload Date</th><td>{{file.upload_date}}</td></tr>
<tr><th>Zeta Configuration</th><td>{{file.zeta_config}}</td></tr>
{% if request.user.is_staff %}
<tr><th colspan="2" style="background:red">Staff Only Information</th></tr>
<tr><th>Sort Title</th><td>{{file.sort_title}}</td></tr>
<tr><th>License</th><td>{{file.file_license}}</td></tr>
<tr><th>License Source</th><td>{{file.license_source}}</td></tr>
<tr><th>Can Spotlight</th><td>{{file.spotlight}}</td></tr>
{% endif %}
</table>

<h2 id="heading-permissions">File Permissions</h2>
{% with file.supported_actions as supported_actions %}
<table class="data-table">
<tr><th>Can Review File</th><td>{{file.can_review|yesno|title}}</td></tr>
<tr><th>Can Download File</th><td>{{file.actions.download|yesno|title}}</td></tr>
<tr><th>Can Play File</th><td>{{file.actions.play|yesno|title}}</td></tr>
<tr><th>Can View File</th><td>{{file.actions.view|yesno|title}}</td></tr>
<tr><th>Can Read File Articles</th><td>{{file.actions.article|yesno|title}}</td></tr>
</table>
{% endwith %}


{% if upload_info %}
<h2 id="heading-upload">File Upload Info</h2>
<table class="data-table" id="tool-info">
    <tr>
        <th>Upload ID</th>
        <td>{{upload_info.id}}</a></td>
    </tr>
    <tr>
        <th>User</th>
        <td>{% if upload_info.user_id %}Registered User{% else %}Unregistered Guest{% endif %}</td>
    </tr>
    <tr>
        <th>Date</th>
        <td>{{upload_info.date}}</td>
    </tr>
    {% if request.user.is_staff %}
    <tr><th colspan="2" style="background:red">Staff Only Information</th></tr>
    <tr><th>Edit Token</th><td>{{upload_info.edit_token}}</td></tr>
    <tr><th>IP</th><td>{{upload_info.ip}}</td></tr>
    <tr><th>Notes</th><td><textarea class="upload-notes">{{upload_info.notes}}</textarea></td></tr>
    <tr><th>Announced on Discord</th><td>{{upload_info.announced|yesno|title}}</td></tr>
    {% endif %}
</table>
{% endif %}

<h2 id="heading-aliases">File Aliases</h2>
<ul class="data-table">
{% for a in file.aliases.all %}
    <li>{{a.alias}}</li>
{% empty %}
    <li><i>None</i></li>
{% endfor %}
</ul>

<h2 id="heading-articles">File Articles</h2>
<ul class="data-table">
{% for a in file.articles.not_removed %}
    <li><a href="{{a.url}}">{{a.title}}</a></li>
{% empty %}
    <li><i>None</i></li>
{% endfor %}
</ul>

<h2 id="heading-contents">File Contents</h2>
<table class="data-table" id="contents-info">
    <tr><th>Filename</th><th>Path</th><th>Ext.</th><th>Mod. Date</th><th>Dir</th><th>CRC-32</th><th>Size</th></tr>
    {% for f in file.content.all %}
    <tr><td><a href="{{file.url}}?file={{f.title|urlencode}}" target="_blank">{{f.title}}</a></td><td>{{f.path}}</td><td>{{f.ext}}</td><td>{{f.mod_date}}</td><td class="c">{{f.directory|yesno:"Y,N"}}</td><td class="r">{{f.crc32}}</td><td class="r" title="{{f.size}} bytes">{{f.size|filesizeformat}}</td></tr>
    {% empty %}
        <tr><td colspan="7" class="c"><i>No Contents Found</i></td></tr>
    {% endfor %}
</table>

<h2 id="heading-details">File Details</h2>
<ul class="data-table">
{% for d in file.details.all %}
<li>{{d.title}}</li>
{% endfor %}
</ul>

<h2 id="heading-downloads">File Downloads</h2>
<ul class="data-table">
{% for d in file.downloads.all %}
    <li><a href="{{d.url}}" target="_blank">{{d.kind}}</a></li>
{% empty %}
    <li><i>None</i></li>
{% endfor %}
</ul>

<h2 id="heading-reviews">File Reviews</h2>
<ul class="data-table">
{% for r in reviews %}
    <li><a href="{{file.review_url}}/#rev-{{r.pk}}">{{r.title}}</a></li>
{% empty %}
    <li><i>None</i></li>
{% endfor %}
</ul>

</section>
{% endblock %}
